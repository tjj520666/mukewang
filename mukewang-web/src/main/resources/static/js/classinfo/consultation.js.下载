define("sc/js/inc/consultation",["store"],function(t){var a,s,i,e,o,n,r=$("#consultation"),c=$(".js-consultation-search-result"),l="",u=function(){var o={searchUrl:"//order.imooc.com/service/consult/ajaxconsultsearch/?type=3&type_id="+OP_CONFIG.plan_id,PutQuestionsUrl:"//order.imooc.com/service/consult/ajaxdoconsult/?type=3&type_id="+OP_CONFIG.plan_id,supportUrl:"//order.imooc.com/service/consult/ajaxpraiseconsult/?advid="},r=t.get("search_value");r&&$(".consultation-search").val(r),a=function(t){for(var a="",s=0;s<t.length;s++)a+="<div class='search-result-item clearfix' data-advid='"+t[s].id+"'>",a+="<div class='search-result-item-left'>",a+=t[s].mypraise?"<div class='support current' data-advid='"+t[s].id+"'>":"<div class='support' data-advid='"+t[s].id+"'>",a+="<i class='imv2-thumb_up'></i>",a+="</div>",a+="<div class='support_num'>"+t[s].praise+"</div>",a+="</div>",a+="<div class='search-result-item-right'>",a+="<h3 class='h3-list'><a title='"+t[s].title+"' href='/sc/consult/detail/"+t[s].id+"' target='_blank'>"+t[s].content+"</a></h3>",a+="<div class='p-list'>",a+="<p>亲，您好~"+t[s].answer+" 祝您学习愉快~</p>",a+="</div>",a+="</div>",a+="</div>";return a},s="<p class='notdata'>暂无任何就业班咨询信息</p>",i="<p class='notdata'>抱歉,没有找到答案,你可以点击“提问”提交此条提问给官方客服，我们会及时回复。</p>",e=function(t,e){t=t||"",e=e||{};var n=e.page||1,r=e.pagesize||6;l=t;var u=o.searchUrl+"&words="+t+"&page="+n+"&pagesize="+r;$.ajax({url:u,type:"GET",dataType:"jsonp"}).done(function(e){if(e.data.total<1)c.html(t?i:s);else{var o=a(e.data.data_adv);c.html(o)}if($(".js-load-page").html(e.data.pager&&e.data.total>15?e.data.pager:""),6==r){var n=$(".hrefall");e.data.total>6?(n.find("span").html(e.data.total),n.show()):n.hide()}})},PutQuestions=function(a){$.confirm("您确认提交此问题吗？",{callback:function(){$.ajax({url:o.PutQuestionsUrl+"&content="+a,type:"post",dataType:"jsonp"}).done(function(a){0==a.result?$.prompt("问题提交成功，回答会以通知形式告知您",{icon:"success",callback:function(){$(".consultation-search").val(""),t.set("search_value",""),e()}}):$.prompt(a.msg,{icon:"error",timeout:1e3})})}})},n=function(t){var a=$(t).parents(".search-result-item"),s=a.find(".support_num"),i=$(t).attr("data-advid");$.ajax({url:o.supportUrl+i,type:"post",dataType:"jsonp"}).done(function(a){0==a.result?$.prompt("点赞成功",{icon:"success",timeout:1e3,callback:function(){s.html(s.html()-0+1),$(t).addClass("current")}}):$.prompt(a.msg,{icon:"error",timeout:1e3})})}};return o=function(a){r.on("input",".consultation-search",function(){var s=$.trim(this.value);t.set("search_value",s),e(s,a)}),r.on("click",".consultation-search-btn",function(){if(!OP_CONFIG.isLogin)return void $("#js-signin-btn").click();var t=$.trim($(".consultation-search").val());return t.length<5?void $.prompt("提问最少输入5个字符",{icon:"error",timeout:1e3}):t.length>50?void $.prompt("提问最多输入50个字符",{icon:"error",timeout:1e3}):void PutQuestions(t)}),r.on("click",".support",function(){return OP_CONFIG.isLogin?$(this).hasClass("current")?void $.prompt("亲已经点过赞了，不能重复点哟！",{icon:"success"}):void n(this):($("#js-signin-btn").click(),!1)}),$(".js-load-page").on("click","a",function(){var t=$(this).data("page");e(l,{page:t,pagesize:15})})},{init:function(t){u(t),e("",t),o(t)}}});