define("sc/js/index",["sc/js/inc/consultation","/static/lib/html2canvas/html2canvas.min.js","sc/js/inc/package","sc/js/inc/search","lib/jquery-fly/jquery.fly","/static/lib/meiqia/meiqia.js"],function(t,e){function i(t,e){var i=t.match(/\.com\/(\S*)\./),a="";t.indexOf("//szimg.")>-1?a="szimg/":t.indexOf("//climg.")>-1&&(a="climg/");var o=i?"https://imgapi.imooc.com/"+a+i[1]+".jpg?format=base64":"";o&&$.ajax({url:o,method:"get",success:function(t){t&&"string"==typeof t&&t.indexOf("base64")>-1&&e&&e(t)}})}function a(){var t=navigator.userAgent,e=t.indexOf("Opera")>-1;return e?"Opera":t.indexOf("Firefox")>-1?"FF":t.indexOf("Chrome")>-1?"Chrome":t.indexOf("Safari")>-1?"Safari":(window.ActiveXObject||"ActiveXObject"in window)&&(/MSIE \d+\.\d+/.test(t)||t.match(/Trident/)&&t.match(/rv/))?"IE":void 0}function o(){var t="png",e=$("#canvas-image img").attr("src"),i=function(t){t=t.toLowerCase().replace(/jpg/i,"jpeg");var e=t.match(/png|jpeg|bmp|gif/)[0];return"image/"+e};e=e.replace(i(t),"image/octet-stream");var a="poster."+t;"IE"==w?n(a,e):c(e,a)}function n(t,e){var i=(document.createElement("a"),s(e));window.navigator.msSaveOrOpenBlob(i,t)}function s(t){for(var e=t.split(";base64,"),i=e[0].split(":")[1],a=window.atob(e[1]),o=a.length,n=new Uint8Array(o),s=0;o>s;++s)n[s]=a.charCodeAt(s);return new Blob([n],{type:i})}function c(t,e){var i=document.createElementNS("http://www.w3.org/1999/xhtml","a");i.href=t,i.download=e;var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),i.dispatchEvent(a)}function r(t){var i=t,a=(window.getComputedStyle(i),i.offsetWidth),o=i.offsetHeight,n=document.createElement("canvas"),s=2;n.width=a*s,n.height=o*s,n.style.width=a+"px",n.style.height=o+"px";var c=n.getContext("2d");c.scale(s,s);var r={scale:2,canvas:n,width:a,height:o,logging:!0,useCORS:!0};e(i,r).then(function(t){var e=t.getContext("2d");e.mozImageSmoothingEnabled=!1,e.webkitImageSmoothingEnabled=!1,e.msImageSmoothingEnabled=!1,e.imageSmoothingEnabled=!1;var i=t.toDataURL("image/png"),a=new Image;a.src=i,$(a).css({width:"300px",height:"533px"}),a.onload=function(){$("#canvas-image").append(a),t.width=t.height=0}})}var d=$(".js-fixed");$(window).on("scroll",function(){var t=$(window).scrollTop(),e=Number($("#scmain").offset().top)+90;t>e?d.addClass("active"):d.removeClass("active")});var l=function(){$("#js-index-video").show(),$("#js-video-close").click(function(){$("#js-index-video").hide().find("#js-video").empty()})},m=function(){$(".js-buy-trigger").on("click",function(){return OP_CONFIG.isLogin?void(window.location.href="//order.imooc.com/pay/buynow?type_id="+OP_CONFIG.plan_id+"&type=4"):($("#js-signin-btn").click(),!1)}),$(".js-buynow").on("click",function(){if(!OP_CONFIG.isLogin)return void $("#js-signin-btn").click();var t="/pay/buynow/?uid="+OP_CONFIG.userInfo.uid+"&type=4&plan_id="+OP_CONFIG.plan_id;window.location.href=t}),$(document).on("click",".js-video-start",function(){var t=$(this).data("videourl");require(["common/js/player"],function(e){e.init({id:"js-video",url:t,videotitile:"实战课程_慕课网",width:"800",height:"500",events:{onReady:function(){this.play()}}})}),l()})},p=function(){m(),t.init()};p();var u=function(t){var e=$(".js-endcart").offset(),i=$("<i class='parabola sz-add-shopping-cart' style='font-size: 40px; color: #b5b9bc;'></i>"),a=$(t).offset().left,o=$(t).offset().top-$(window).scrollTop();i.fly({start:{left:a,top:o},end:{left:e.left,top:e.top-$(window).scrollTop(),width:20,height:20,callback:function(){$(".parabola").remove();var t=parseInt($(".js-cart-num").attr("data-cartnum")),e=parseInt($(".js-cart-num").attr("data-ordernum"));$(".js-cart-num").html(parseInt(t+1+e)).attr("data-cartnum",parseInt(t+1)).show(),$.initGetCart()}}});$(".js-cart-num").html()},g=!1;$("body").on("click",".js-addcart",function(t){t.stopPropagation();var e=this;if(!g){g=!0;var i=$(this).attr("data-cid"),a=$(this).attr("data-type"),o={type_id:i,type:a};return $.ajax({url:"//order.imooc.com/pay/addtocart",dataType:"jsonp",data:o,jsonp:"jsonpcallback",success:function(i){"0"==i.result?(_cartFlag=1,u(e,t)):$.alert(i.msg),g=!1}}),t.preventDefault(),!1}});var h=$(".right-more").attr("href");$(".js-classify").on("click","li",function(){var t=$(this).parents(".plan-list-box").find(".right-more").attr("num"),e=$(this).attr("list-id");$(this).siblings("li").removeClass("active"),$(this).addClass("active"),$("#list_"+e).siblings(".middle-list").hide(),$("#list_"+e).show();var i="";if(2==t)switch(e){case"00":i=h;break;case"01":i=h+"&plan=1"}else if(3==t)switch(e){case"00":i=h;break;case"01":i=h+"&plan=1";break;case"02":i=h+"&plan=2"}$(this).parents(".plan-list-box").find(".right-more").attr("href",i)});var f=function(t){var e="http://www.imooc.com/act/bargain/mybreaks/detail?u="+t.uid+"&t="+t.type+"&ti="+t.type_id+"&bargain_id="+t.bargain_id+"&isqr=1",i='<div class="share-link"><div class="link-item"><div class="link-content"><div class="qr-code" id="phonecode" data-srcs="'+e+'"></div></div><p>手机端扫码分享给好友</p></div><div class="link-item"><div class="link-content"><div class="link-img"><img src="/static/module/index/img/modal-computer.png"></div><button class="modal-btn js-get-url">复制链接</button></div><p>电脑端复制分享给好友</p></div></div><a href="//www.imooc.com/act/share"><img src="/static/module/index/img/pop-bg.png"></a><input id="copy" type="text" style="width:1px; height:1px; overflow:hidden;">';return i};if($(".close-enter").click(function(){$("#bargain_enter").remove()}),$(".js-course-cut").click(function(){var t=$(this);if(t.hasClass("loading"))return!1;t.addClass("loading");var e=$(this).data("uid");if(e=e.split("-"),0==e[0])$("#js-signin-btn").trigger("click"),t.removeClass("loading");else if(0==e[3])window.open("//www.imooc.com/act/share"),t.removeClass("loading");else{var i={uid:e[1],type:4,type_id:e[2]};$.ajax({url:"//coding.imooc.com/wap/bargainurl",type:"post",dataType:"json",data:i,success:function(){$.dialog(f(i),{title:" ",width:540,height:304,modal:!0,callback:function(){t.removeClass("loading")}});new QRCode("phonecode",{text:$("#phonecode").data("srcs"),width:170,height:170,colorDark:"#000",colorLight:"#FFF",correctLevel:QRCode.CorrectLevel.H});$(".moco-modal-dialog").css("padding",0),a(i)}})}var a=function(t){$(".js-get-url").click(function(){$.ajax({async:!1,url:"//coding.imooc.com/wap/bargainadd",type:"post",dataType:"json",data:t,success:function(e){if(0==e.result){var i="//www.imooc.com/act/bargain/mybreaks/detail?u="+t.uid+"&t="+t.type+"&ti="+t.type_id+"&bargain_id="+e.data.bargain_id,a=document.getElementById("copy");a.value=i,a.focus(),a.select();var o=document.execCommand("cut");a.blur(),o?($(".moco-modal-layer").hide(),t.isreset?$.dialog('<p style="padding:20px;">复制成功！快去分享给好友砍价吧~</p>',{timeout:1500,modal:!0,callback:function(){window.location.reload()}}):$.dialog('<p style="padding:20px;">复制成功！快去分享给好友砍价吧~</p>',{timeout:1500,modal:!0}),setTimeout(function(){$(".js-modal-close").trigger("click")},1600)):$.dialog('<p style="padding:20px;">复制失败！请重试！</p>',{timeout:500,modal:!0})}else $.dialog('<p style="padding:20px;">'+e.msg+"</p>",{timeout:1500,modal:!0})}})})}}),zhuge.track("ContentPage",{Category:"就业班",Name:courseInfo.Name||"",CID:courseInfo.CID,Direction:courseInfo.Direction,Price:parseFloat(final_price),Students:parseFloat(courseInfo.Students||"0"),Score:parseFloat(courseInfo.Score||"0")}),$(".js-share-present").click(function(){if(!OP_CONFIG.isLogin)return void $("#js-signin-btn").trigger("click");var t=$(this).data("id"),e=$(this).data("type"),i=$(this).data("name");$.ajax({url:"//coding.imooc.com/api/shorturl",type:"post",dataType:"json",data:{obj_id:t,obj_type:e,uid:OP_CONFIG.userInfo.uid},success:function(t){return 0!=t.result?($.prompt(t.msg||"通信错误，请稍后再试！",1500),void(canClickDist=!0)):(url=t.data.short_url,$("#modal-dist-share").modal({zIndex:100,opacity:.5}),$(".close-modal").html("").addClass("imv2-close"),$(".dist-copy-content").val("推荐你慕课网这门课，值得花钱好好学一下。《"+i+"》"+url),window.dist_url=url,canClickDist=!0,void 0)},error:function(t){$.prompt(t.msg||"通信错误，请稍后再试！",1500),canClickDist=!0}})}),$(document).on("click",".js-copy-dist",function(){$("input.dist-copy-content").select();var t=document.getElementsByClassName("dist-copy-content")[0];$(t).attr("type","text"),t.select(),document.execCommand("copy"),$(t).attr("type","hidden"),$.prompt("复制成功！",{timeout:2e3})}),OP_CONFIG.isLogin){var v=$(".js-header-avator img").attr("src");v?i(v||"",function(t){$(".js-poster-avator .header-img").attr("src",t)}):$("#header-avator").on("userInfoLoaded",function(){v=$(".js-header-avator img").attr("src"),i(v||"",function(t){$(".js-poster-avator .header-img").attr("src",t)})})}$(document).on("click",".js-poster",function(){$(this).data("id");if($("#modal-dist-share").hide(),$("#modal-dist-poster").modal({zIndex:101,opacity:.5}),$(".close-modal").html("").addClass("imv2-close"),$("#canvas-image img").length)$("#canvas-image").show(),$("#modal-dist-poster").css({top:"50%",marginTop:"-271px"});else{{new QRCode("qrcode",{render:"canvas",text:window.dist_url,width:80,height:80,colorDark:"#000",colorLight:"#FFF",correctLevel:QRCode.CorrectLevel.H})}r($("#canvas-contnet")[0],0)}});var w=a();"IE"==w&&$(".js-poster").hide(),$(document).on("click",".js-close-poster",function(){$("#modal-dist-poster").hide(),$(".jquery-modal").hide(),$("#canvas-image").hide()}),$(document).on("click",".js-down-poster",function(){o()});_MEIQIA("init")});